---
title: mise で esptool を簡単に導入する
tags:
  - Elixir
  - ESP32
  - AtomVM
  - esptool
  - mise
private: false
updated_at: '2025-12-20T07:28:44+09:00'
id: 7edc08991d809934d85c
organization_url_name: fukuokaex
slide: false
ignorePublish: false
---
## はじめに

[AtomVM] 開発などで [ESP32] を扱う時に [esptool] がよく登場します。

https://doc.atomvm.org/latest/getting-started-guide.html#getting-started-on-the-esp32-platform

公式の導入手順では Python の仮想環境を使うやり方とか色々でてきて、Python に慣れていない私にはややこしく見えます。

https://docs.espressif.com/projects/esptool/en/latest/esp32/installation.html

普段 `mise` をいろんなツールの管理に使っています。 `mise` にはいろんなバックエンドと連携してツールをインストールする機能がありますときいてはいましたが、まだ試していませんでした。

https://mise.jdx.dev/dev-tools/backend_architecture.html#language-package-managers

https://qiita.com/haw_ohnuma/items/2d782905aa6e14c28f32

https://qiita.com/haw_ohnuma/items/acf2d7b6cf96ea9c6831

そこで、今回は `pipx` 連携で `esptool` をインストールすることに挑戦してみることにしました。

![piyopiyo-board-2025-12.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/82804/31d01365-5ac5-45dd-a125-bee49ea93d57.png)

※ 写真はイメージです

## 対象環境

- `mise` はすでに導入済み
- `pipx` はすでに導入済み
- `python` はすでに導入済み

```bash
mise --version
pipx --version
python --version
```

pipx は各 OS のシステムパッケージでインストールできるようです。手元のマシンでは、Debian系なので、`sudo apt install pipx` でインストールしました。

https://pipx.pypa.io/stable/

公式ドキュメントによると、`esptool` の最新版には Python 3.10以上と書いてあるので、古い Python を使っている場合は `esptool` のバージョンを固定するなどの工夫が必要になるかもしれません。

> You will need Python 3.10 or newer installed on your system to use the latest version of esptool. If your use case requires Python 3.7, 3.8, or 3.9, please use esptool v4.x. For Python 2.7, 3.4, 3.5, or 3.6, please use esptool v3.3.* instead.

https://docs.espressif.com/projects/esptool/en/latest/esp32/installation.html

## インストール

```bash
mise use --global pipx:esptool
```

たとえば Python 3.9 を使っていて、esptool v4 を指定したいときはこんな感じでできます。

```bash
mise use --global pipx:esptool@4
```

## アンインストール

インストール済みの実体を削除するだけの場合

```bash
mise uninstall pipx:esptool
```

設定ファイルからも消したい場合

```bash
mise unuse pipx:esptool
```

## idf.py が動かなくなったときの対処

今回の `esptool` のインストールし直しが直接影響したのかどうかわかりませんが、しばらくしてから [ESP-IDF] のコマンドを実行したら、エラーが出て戸惑いました。

ついでに Python のバージョンを最新版にしたからかもしれません。Python はちょっと前のバージョンにロックしておいたほうがトラブルが少ないのかもしれません。しらんけど。

```bash
$ source ~/esp/esp-idf/export.fish

Checking "python3" ...
Python 3.14.2
python3 has been detected
Activating ESP-IDF 5.4
* Checking python version ... 3.14.2
* Checking python dependencies ... FAILED
error:  Command "/home/mnishiguchi/.espressif/python_env/idf5.4_py3.14_env/bin/python /home/mnishiguchi/esp/esp-idf/tools/idf_tools.py check-python-dependencies" failed with error code 255
The following Python requirements are not satisfied:
Error while checking requirement 'esptool~=4.8'. Package was not found and is required by the application: No package metadata was found for esptool
Error while checking requirement 'psutil'. Package was not found and is required by the application: No package metadata was found for esptool
Error while checking requirement 'psutil'. Package was not found and is required by the application: No package metadata was found for esptool
To install the missing packages, please run "install.sh"
Diagnostic information:
    IDF_PYTHON_ENV_PATH: /home/mnishiguchi/.espressif/python_env/idf5.4_py3.14_env
    Python interpreter used: /home/mnishiguchi/.espressif/python_env/idf5.4_py3.14_env/bin/python
Constraint file: /home/mnishiguchi/.espressif/espidf.constraints.v5.4.txt
Requirement files:
 - /home/mnishiguchi/esp/esp-idf/tools/requirements/requirements.core.txt
Python being checked: /home/mnishiguchi/.espressif/python_env/idf5.4_py3.14_env/bin/python


ERROR: Activation script failed
To view detailed debug information, set ESP_IDF_EXPORT_DEBUG=1 and run the export script again.
```

最終的に、以下のように [ESP-IDF] をインストールし直したら、解消できました。

```bash
rm -rf ~/.espressif/python_env/*

~/esp/esp-idf/install.fish
source ~/esp/esp-idf/export.fish
```

## おわりに

公式手順にはいろんなやりかたが細かく書かれていますが、`mise` の `pipx` 連携を利用するとあっさり簡単にできてしまいました。

自分の環境では `esptool` はいつでも使える便利な道具なので、こういうかんたんな入れ方が一番うれしいです。

これで後は、[AtomVM] と [ESP32] で遊ぶだけ！

:tada::tada::tada:

https://piyopiyoex.connpass.com/event/377298/

[NervesJP]: https://nerves-jp.connpass.com/
[piyopiyo.ex]: https://piyopiyoex.connpass.com/
[autoracex]: https://autoracex.connpass.com/
[IoT]: https://www.google.com/search?q=IoT%E3%81%A8%E3%81%AF
[AtomVM]: https://github.com/atomvm/AtomVM
[Elixir]: https://hexdocs.pm/elixir/introduction.html
[Nerves]: https://github.com/nerves-project
[SWEST27]: https://swest.toppers.jp/phx/
[Seeed Studio XIAO ESP32-S3]: https://wiki.seeedstudio.com/xiao_esp32s3_getting_started/
[ESP32]: https://www.google.com/search?q=ESP32%E3%81%A8%E3%81%AF
[ESP32-S3]: https://www.espressif.com/ja-jp/products/socs/esp32-s3
[AtomVM/releases]: https://github.com/atomvm/AtomVM/releases
[AtomVM/doc/getting-started]: https://doc.atomvm.org/latest/getting-started-guide.html#getting-started-on-the-esp32-platform
[Blinky]: https://github.com/atomvm/atomvm_examples/tree/master/elixir/Blinky
[Erlang]: https://www.erlang.org/doc/readme.html
[ESP-IDF]: https://docs.espressif.com/projects/esp-idf/en/stable/esp32s3/get-started/
[esptool]: https://docs.espressif.com/projects/esptool/en/latest/esp32/
[screen]: https://www.google.com/search?q=screen+linux
[minicom]: https://www.google.com/search?q=minicom+linux
[picocom]: https://www.google.com/search?q=picocom+linux
[AtomVM/releases]: https://github.com/atomvm/AtomVM/releases
[Blink]: https://github.com/atomvm/AtomVM/blob/main/examples/elixir/esp32/Blink.ex
[exatomvm]: https://github.com/atomvm/exatomvm
